#include "commandp.h"
#include <QCoreApplication>
#include <QTcpSocket>
#include <QElapsedTimer>
#include <QMap>
#include <QDebug>
#include <QString>
#include <QThread>
using namespace std;
commandp::commandp(QObject *parent)
    : QObject{parent}
{}
QMap<int, QString> commandp::getServiceNames() {
    return {
        { 1, "tcpmux" },
        { 3, "compressnet" },
        { 4, "unknown" },
        { 6, "unknown" },
        { 7, "echo" },
        { 9, "discard" },
        { 13, "daytime" },
        { 17, "qotd" },
        { 19, "chargen" },
        { 20, "ftp-data" },
        { 21, "ftp" },
        { 22, "ssh" },
        { 23, "telnet" },
        { 24, "priv-mail" },
        { 25, "smtp" },
        { 26, "rsftp" },
        { 30, "unknown" },
        { 32, "unknown" },
        { 33, "dsp" },
        { 37, "time" },
        { 42, "nameserver" },
        { 43, "whois" },
        { 49, "tacacs" },
        { 53, "domain" },
        { 70, "gopher" },
        { 79, "finger" },
        { 80, "http" },
        { 81, "hosts2-ns" },
        { 82, "xfer" },
        { 83, "mit-ml-dev" },
        { 84, "ctf" },
        { 85, "mit-ml-dev" },
        { 88, "kerberos-sec" },
        { 89, "su-mit-tg" },
        { 90, "dnsix" },
        { 99, "metagram" },
        { 100, "newacct" },
        { 106, "pop3pw" },
        { 109, "pop2" },
        { 110, "pop3" },
        { 111, "rpcbind"},
        { 113, "ident"},
        { 119, "nntp"},
        { 125, "locus-map"},
        { 135, "msrpc"},
        { 139, "netbios-ssn"},
        { 143, "imap"},
        { 144, "news"},
        { 146, "iso-tp0"},
        { 161, "snmp"},
        { 163, "cmip-man"},
        { 179, "bgp"},
        { 199, "smux"},
        { 211, "914c-g"},
        { 212, "anet"},
        { 222, "rsh-spx"},
        { 254, "unknown"},
        { 255, "unknown"},
        { 256, "fw1-secureremote"},
        { 259, "esro-gen"},
        { 264, "bgmp"},
        { 280, "http-mgmt"},
        { 301, "unknown"},
        { 306, "unknown"},
        { 311, "asip-webadmin"},
        { 340, "unknown"},
        { 366, "odmr"},
        { 389, "ldap"},
        { 406, "imsp"},
        { 407, "timbuktu"},
        { 416, "silverplatter"},
        { 417, "onmux"},
        { 425, "icad-el"},
        { 427, "svrloc"},
        { 443, "https"},
        { 444, "snpp"},
        { 445, "microsoft-ds"},
        { 458, "appleqtc"},
        { 464, "kpasswd5"},
        { 465, "smtps"},
        { 481, "dvs"},
        { 497, "retrospect"},
        { 500, "isakmp"},
        { 512, "exec"},
        { 513, "login"},
        { 514, "shell"},
        { 515, "printer"},
        { 524, "ncp"},
        { 541, "uucp-rlogin"},
        { 543, "klogin"},
        { 544, "kshell"},
        { 545, "ekshell"},
        { 548, "afp"},
        { 554, "rtsp"},
        { 555, "dsf"},
        { 563, "snews"},
        { 587, "submission"},
        { 593, "http-rpc-epmap"},
        { 616, "sco-sysmgr"},
        { 617, "sco-dtmgr"},
        { 625, "apple-xsrvr-admin"},
        { 631, "ipp"},
        { 636, "ldapssl"},
        { 646, "ldp"},
        { 648, "rrp"},
        { 666, "doom"},
        { 667, "disclose"},
        { 668, "mecomm"},
        { 683, "corba-iiop"},
        { 687, "asipregistry"},
        { 691, "resvc"},
        { 700, "epp"},
        { 705, "agentx"},
        { 711, "cisco-tdp"},
        { 714, "iris-xpcs"},
        { 720, "unknown"},
        { 722, "unknown"},
        { 726, "unknown"},
        { 749, "kerberos-adm"},
        { 765, "webster"},
        { 777, "multiling-http"},
        { 783, "spamassassin"},
        { 787, "qsc"},
        { 800, "mdbs_daemon"},
        { 801, "device"},
        { 808, "ccproxy-http"},
        { 843, "unknown"},
        { 873, "rsync"},
        { 880, "unknown"},
        { 888, "accessbuilder"},
        { 898, "sun-manageconsole"},
        { 900, "omginitialrefs"},
        { 901, "samba-swat"},
        { 902, "iss-realsecure"},
        { 903, "iss-console-mgr"},
        { 911, "xact-backup"},
        { 912, "apex-mesh"},
        { 981, "unknown"},
        { 987, "unknown"},
        { 990, "ftps"},
        { 992, "telnets"},
        { 993, "imaps"},
        { 995, "pop3s"},
        { 999, "garcon"},
        { 1000, "cadlock"},
        { 1001, "webpush"},
        { 1002, "windows-icfw"},
        {1007, "unknown"},
        {1009, "unknown"},
        {1010, "surf"},
        {1011, "unknown"},
        {1021, "exp1"},
        {1022, "exp2"},
        {1023, "netvenuechat"},
        {1024, "kdm"},
        {1025, "NFS-or-IIS"},
        {1026, "LSA-or-nterm"},
        {1027, "IIS"},
        {1028, "unknown"},
        {1029, "ms-lsa"},
        {1030, "iad1"},
        {1031, "iad2"},
        {1032, "iad3"},
        {1033, "netinfo"},
        {1034, "zincite-a"},
        {1035, "multidropper"},
        {1036, "nsstp"},
        {1037, "ams"},
        {1038, "mtqp"},
        {1039, "sbl"},
        {1040, "netsaint"},
        {1041, "danf-ak2"},
        {1042, "afrog"},
        {1043, "boinc"},
        {1044, "dcutility"},
        {1045, "fpitp"},
        {1046, "wfremotertm"},
        {1047, "neod1"},
        {1048, "neod2"},
        {1049, "td-postman"},
        {1050, "java-or-OTGfileshare"},
        {1051, "optima-vnet"},
        {1052, "ddt"},
        {1053, "remote-as"},
        {1054, "brvread"},
        {1055, "ansyslmd"},
        {1056, "vfo"},
        {1057, "startron"},
        {1058, "nim"},
        {1059, "nimreg"},
        {1060, "polestar"},
        {1061, "kiosk"},
        {1062, "veracity"},
        {1063, "kyoceranetdev"},
        {1064, "jstel"},
        {1065, "syscomlan"},
        {1066, "fpo-fns"},
        {1067, "instl_boots"},
        {1068, "instl_bootc"},
        {1069, "cognex-insight"},
        {1070, "gmrupdateserv"},
        {1071, "bsquare-voip"},
        {1072, "cardax"},
        {1073, "bridgecontrol"},
        {1074, "warmspotMgmt"},
        {1075, "rdrmshc"},
        {1076, "sns_credit"},
        {1077, "imgames"},
        {1078, "avocent-proxy"},
        {1079, "asprovatalk"},
        {1080, "socks"},
        {1081, "pvuniwien"},
        {1082, "amt-esd-prot"},
        {1083, "ansoft-lm-1"},
        {1084, "ansoft-lm-2"},
        {1085, "webobjects"},
        {1086, "cplscrambler-lg"},
        {1087, "cplscrambler-in"},
        {1088, "cplscrambler-al"},
        {1089, "ff-annunc"},
        {1090, "ff-fms"},
        {1091, "ff-sm"},
        {1092, "obrpd"},
        {1093, "proofd"},
        {1094, "rootd"},
        {1095, "nicelink"},
        {1096, "cnrprotocol"},
        {1097, "sunclustermgr"},
        {1098, "rmiactivation"},
        {1099, "rmiregistry"},
        {1100, "mctp"},
        {1102, "adobeserver-1"},
        {1104, "xrl"},
        {1105, "ftranhc"},
        {1106, "isoipsigport-1"},
        {1107, "isoipsigport-2"},
        {1108, "ratio-adp"},
        {1110, "nfsd-status"},
        {1111, "lmsocialserver"},
        {1112, "msql"},
        {1113, "ltp-deepspace"},
        {1114, "mini-sql"},
        {1117, "ardus-mtrns"},
        {1119, "bnetgame"},
        {1121, "rmpp"},
        {1122, "availant-mgr"},
        {1123, "murray"},
        {1124, "hpvmmcontrol"},
        {1126, "hpvmmdata"},
        {1130, "casp"},
        {1131, "caspssl"},
        {1132, "kvm-via-ip"},
        {1137, "trim"},
        {1138, "encrypted_admin"},
        {1141, "mxomss"},
        {1145, "x9-icue"},
        {1147, "capioverlan"},
        {1148, "elfiq-repl"},
        {1149, "bvtsonar"},
        {1151, "unizensus"},
        {1152, "winpoplanmess"},
        {1154, "resacommunity"},
        {1163, "sddp"},
        {1164, "qsm-proxy"},
        {1165, "qsm-gui"},
        {1166, "qsm-remote"},
        {1169, "tripwire"},
        {1174, "fnet-remote-ui"},
        {1175, "dossier"},
        {1183, "llsurfup-http"},
        {1185, "catchpole"},
        {1186, "mysql-cluster"},
        {1187, "alias"},
        {1192, "caids-sensor"},
        {1198, "cajo-discovery"},
        {1199, "dmidi"},
        {1201, "nucleus-sand"},
        {1213, "mpc-lifenet"},
        {1216, "etebac5"},
        {1217, "hpss-ndapi"},
        {1218, "aeroflight-ads"},
        {1233, "univ-appserver"},
        {1234, "hotline"},
        {1236, "bvcontrol"},
        {1244, "isbconference1"},
        {1247, "visionpyramid"},
        {1248, "hermes"},
        {1259, "opennl-voice"},
        {1271, "excw"},
        {1272, "cspmlockmgr"},
        {1277, "miva-mqs"},
        {1287, "routematch"},
        {1296, "dproxy"},
        {1300, "h323hostcallsc"},
        {1301, "ci3-software-1"},
        {1309, "jtag-server"},
        {1310, "husky"},
        {1311, "rxmon"},
        {1322, "novation"},
        {1328, "ewall"},
        {1334, "writesrv"},
        {1352, "lotusnotes"},
        {1417, "timbuktu-srv1"},
        {1433, "ms-sql-s"},
        {1434, "ms-sql-m"},
        {1443, "ies-lm"},
        {1455, "esl-lm"},
        {1461, "ibm_wrless_lan"},
        {1494, "citrix-ica"},
        {1500, "vlsi-lm"},
        {1501, "sas-3"},
        {1503, "imtc-mcs"},
        {1521, "oracle"},
        {1524, "ingreslock"},
        {1533, "virtual-places"},
        {1556, "veritas_pbx"},
        {1580, "tn-tl-r1"},
        {1583, "simbaexpress"},
        {1594, "sixtrak"},
        {1600, "issd"},
        {1641, "invision"},
        {1658, "sixnetudr"},
        {1666, "netview-aix-6"},
        {1687, "nsjtp-ctrl"},
        {1688, "nsjtp-data"},
        {1700, "mps-raft"},
        {1717, "fj-hdnet"},
        {1718, "h323gatedisc"},
        {1719, "h323gatestat"},
        {1720, "h323q931"},
        {1721, "caicci"},
        {1723, "pptp"},
        {1755, "wms"},
        {1761, "landesk-rc"},
        {1782, "hp-hcip"},
        {1783, "unknown"},
        {1801, "msmq"},
        {1805, "enl-name"},
        {1812, "radius"},
        {1839, "netopia-vo1"},
        {1840, "netopia-vo2"},
        {1862, "mysql-cm-agent"},
        {1863, "msnp"},
        {1864, "paradym-31"},
        {1875, "westell-stats"},
        {1900, "upnp"},
        {1914, "elm-momentum"},
        {1935, "rtmp"},
        {1947, "sentinelsrm"},
        {1971, "netop-school"},
        {1972, "intersys-cache"},
        {1974, "drp"},
        {1984, "bigbrother"},
        {1998, "x25-svc-port"},
        {1999, "tcp-id-port"},
        {2000, "cisco-sccp"},
        {2001, "dc"},
        {2002, "globe"},
        {2003, "finger"},
        {2004, "mailbox"},
        {2005, "deslogin"},
        {2006, "invokator"},
        {2007, "dectalk"},
        {2008, "conf"},
        {2009, "news"},
        {2010, "search"},
        {2013, "raid-am"},
        {2020, "xinupageserver"},
        {2021, "servexec"},
        {2022, "down"},
        {2030, "device2"},
        {2033, "glogger"},
        {2034, "scoremgr"},
        {2035, "imsldoc"},
        {2038, "objectmanager"},
        {2040, "lam"},
        {2041, "interbase"},
        {2042, "isis"},
        {2043, "isis-bcast"},
        {2045, "cdfunc"},
        {2046, "sdfunc"},
        {2047, "dls"},
        {2048, "dls-monitor"},
        {2049, "nfs"},
        {2065, "dlsrpn"},
        {2068, "avocentkvm"},
        {2099, "h2250-annex-g"},
        {2100, "amiganetfs"},
        {2103, "zephyr-clt"},
        {2105, "eklogin"},
        {2106, "ekshell"},
        {2107, "msmq-mgmt"},
        {2111, "kx"},
        {2119, "gsigatekeeper"},
        {2121, "ccproxy-ftp"},
        {2126, "pktcable-cops"},
        {2135, "gris"},
        {2144, "lv-ffx"},
        {2160, "apc-2160"},
        {2161, "apc-agent"},
        {2170, "eyetv"},
        {2179, "vmrdp"},
        {2190, "tivoconnect"},
        {2191, "tvbus"},
        {2196, "unknown"},
        {2200, "ici"},
        {2222, "EtherNetIP-1"},
        {2251, "dif-port"},
        {2260, "apc-2260"},
        {2288, "netml"},
        {2301, "compaqdiag"},
        {2323, "3d-nfsd"},
        {2366, "qip-login"},
        {2381, "compaq-https"},
        {2382, "ms-olap3"},
        {2383, "ms-olap4"},
        {2393, "ms-olap1"},
        {2394, "ms-olap2"},
        {2399, "fmpro-fdal"},
        {2401, "cvspserver"},
        {2492, "groove"},
        {2500, "rtsserv"},
        {2522, "windb"},
        {2525, "ms-v-worlds"},
        {2557, "nicetec-mgmt"},
        {2601, "zebra"},
        {2602, "ripd"},
        {2604, "ospfd"},
        {2605, "bgpd"},
        {2607, "connection"},
        {2608, "wag-service"},
        {2638, "sybase"},
        {2701, "sms-rcinfo"},
        {2702, "sms-xfer"},
        {2710, "sso-service"},
        {2717, "pn-requester"},
        {2718, "pn-requester2"},
        {2725, "msolap-ptp2"},
        {2800, "acc-raid"},
        {2809, "corbaloc"},
        {2811, "gsiftp"},
        {2869, "icslap"},
        {2875, "dxmessagebase2"},
        {2909, "funk-dialout"},
        {2910, "tdaccess"},
        {2920, "roboeda"},
        {2967, "symantec-av"},
        {2968, "enpp"},
        {2998, "iss-realsec"},
        {3000, "ppp"},
        {3001, "nessus"},
        {3003, "cgms"},
        {3005, "deslogin"},
        {3006, "deslogind"},
        {3007, "lotusmtap"},
        {3011, "trusted-web"},
        {3013, "gilatskysurfer"},
        {3017, "event_listener"},
        {3030, "arepa-cas"},
        {3031, "eppc"},
        {3052, "powerchute"},
        {3071, "csd-mgmt-port"},
        {3077, "orbix-loc-ssl"},
        {3128, "squid-http"},
        {3168, "poweronnud"},
        {3211, "avsecuremgmt"},
        {3221, "xnm-clear-text"},
        {3260, "iscsi"},
        {3261, "winshadow"},
        {3268, "globalcatLDAP"},
        {3269, "globalcatLDAPssl"},
        {3283, "netassistant"},
        {3300, "ceph"},
        {3301, "tarantool"},
        {3306, "mysql"},
        {3322, "active-net"},
        {3323, "active-net"},
        {3324, "active-net"},
        {3325, "active-net"},
        {3333, "dec-notes"},
        {3351, "btrieve"},
        {3367, "satvid-datalnk"},
        {3369, "satvid-datalnk"},
        {3370, "satvid-datalnk"},
        {3371, "satvid-datalnk"},
        {3372, "msdtc"},
        {3389, "ms-wbt-server"},
        {3390, "dsc"},
        {3404, "unknown"},
        {3476, "nppmp"},
        {3493, "nut"},
        {3517, "802-11-iapp"},
        {3527, "beserver-msg-q"},
        {3546, "unknown"},
        {3551, "apcupsd"},
        {3580, "nati-svrloc"},
        {3659, "apple-sasl"},
        {3689, "rendezvous"},
        {3690, "svn"},
        {3703, "adobeserver-3"},
        {3737, "xpanel"},
        {3766, "sitewatch-s"},
        {3784, "bfd-control"},
        {3800, "pwgpsi"},
        {3801, "ibm-mgr"},
        {3809, "apocd"},
        {3814, "neto-dcs"},
        {3826, "wormux"},
        {3827, "netmpi"},
        {3828, "neteh"},
        {3851, "spectraport"},
        {3869, "ovs-mgmt"},
        {3871, "avocent-adsap"},
        {3878, "fotogcad"},
        {3880, "igrs"},
        {3889, "dandv-tester"},
        {3905, "mupdate"},
        {3914, "listcrt-port-2"},
        {3918, "pktcablemmcops"},
        {3920, "exasoftport1"},
        {3945, "emcads"},
        {3971, "lanrevserver"},
        {3986, "mapper-ws_ethd"},
        {3995, "iss-mgmt-ssl"},
        {3998, "dnx"},
        {4000, "remoteanything"},
        {4001, "newoak"},
        {4002, "mlchat-proxy"},
        {4003, "pxc-splr-ft"},
        {4004, "pxc-roid"},
        {4005, "pxc-pin"},
        {4006, "pxc-spvr"},
        {4045, "lockd"},
        {4111, "xgrid"},
        {4125, "rww"},
        {4126, "ddrepl"},
        {4129, "nuauth"},
        {4224, "xtell"},
        {4242, "vrml-multi-use"},
        {4279, "vrml-multi-use"},
        {4321, "rwhois"},
        {4343, "unicall"},
        {4443, "pharos"},
        {4444, "krb524"},
        {4445, "upnotifyp"},
        {4446, "n1-fwp"},
        {4449, "privatewire"},
        {4550, "gds-adppiw-db"},
        {4567, "tram"},
        {4662, "edonkey"},
        {4848, "appserv-http"},
        {4899, "radmin"},
        {4900, "hfcs"},
        {4998, "maybe-veritas"},
        {5000, "upnp"},
        {5001, "commplex-link"},
        {5002, "rfe"},
        {5003, "filemaker"},
        {5004, "avt-profile-1"},
        {5009, "airport-admin"},
        {5030, "surfpass"},
        {5033, "jtnetd-server"},
        {5050, "mmcc"},
        {5051, "ida-agent"},
        {5054, "rlm-admin"},
        {5060, "sip"},
        {5061, "sip-tls"},
        {5080, "onscreen"},
        {5087, "biotic"},
        {5100, "admd"},
        {5101, "admdog"},
        {5102, "admeng"},
        {5120, "barracuda-bbs"},
        {5190, "aol"},
        {5200, "targus-getdata"},
        {5214, "unknown"},
        {5221, "3exmp"},
        {5222, "xmpp-client"},
        {5225, "hp-server"},
        {5226, "hp-status"},
        {5269, "xmpp-server"},
        {5280, "xmpp-bosh"},
        {5298, "presence"},
        {5357, "wsdapi"},
        {5405, "pcduo"},
        {5414, "statusd"},
        {5431, "park-agent"},
        {5432, "postgresql"},
        {5440, "unknown"},
        {5500, "hotline"},
        {5510, "secureidprop"},
        {5544, "unknown"},
        {5550, "sdadmind"},
        {5555, "freeciv"},
        {5560, "isqlplus"},
        {5566, "westec-connect"},
        {5631, "pcanywheredata"},
        {5633, "beorl"},
        {5666, "nrpe"},
        {5678, "rrac"},
        {5679, "activesync"},
        {5718, "dpm"},
        {5730, "unieng"},
        {5800, "vnc-http"},
        {5801, "vnc-http-1"},
        {5802, "vnc-http-2"},
        {5810, "unknown"},
        {5811, "unknown"},
        {5815, "unknown"},
        {5822, "unknown"},
        {5825, "unknown"},
        {5850, "unknown"},
        {5859, "wherehoo"},
        {5862, "unknown"},
        {5877, "unknown"},
        {5900, "vnc"},
        {5901, "vnc-1"},
        {5902, "vnc-2"},
        {5903, "vnc-3"},
        {5904, "ag-swim"},
        {5906, "rpas-c2"},
        {5907, "dsd"},
        {5910, "cm"},
        {5911, "cpdlc"},
        {5915, "unknown"},
        {5922, "unknown"},
        {5925, "unknown"},
        {5950, "unknown"},
        {5952, "unknown"},
        {5959, "unknown"},
        {5960, "unknown"},
        {5961, "unknown"},
        {5962, "unknown"},
        {5963, "indy"},
        {5987, "wbem-rmi"},
        {5988, "wbem-http"},
        {5989, "wbem-https"},
        {5998, "ncd-diag"},
        {5999, "ncd-conf"},
        {6000, "X11"},
        {6001, "X11:1"},
        {6002, "X11:2"},
        {6003, "X11:3"},
        {6004, "X11:4"},
        {6005, "X11:5"},
        {6006, "X11:6"},
        {6007, "X11:7"},
        {6009, "X11:9"},
        {6025, "x11"},
        {6059, "X11:59"},
        {6100, "synchronet-db"},
        {6101, "backupexec"},
        {6106, "isdninfo"},
        {6112, "dtspc"},
        {6123, "backup-express"},
        {6129, "unknown"},
        {6156, "unknown"},
        {6346, "gnutella"},
        {6389, "clariion-evr01"},
        {6502, "netop-rc"},
        {6510, "mcer-port"},
        {6543, "mythtv"},
        {6547, "powerchuteplus"},
        {6565, "unknown"},
        {6566, "sane-port"},
        {6567, "esp"},
        {6580, "parsec-master"},
        {6646, "unknown"},
        {6666, "irc"},
        {6667, "irc"},
        {6668, "irc"},
        {6669, "irc"},
        {6689, "tsa"},
        {6692, "unknown"},
        {6699, "napster"},
        {6779, "unknown"},
        {6788, "smc-http"},
        {6789, "ibm-db2-admin"},
        {6792, "unknown"},
        {6839, "unknown"},
        {6881, "bittorrent-tracker"},
        {6901, "jetstream"},
        {6969, "acmsoda"},
        {7000, "afs3-fileserver"},
        {7001, "afs3-callback"},
        {7002, "afs3-prserver"},
        {7004, "afs3-kaserver"},
        {7007, "afs3-bos"},
        {7019, "doceri-ctl"},
        {7025, "vmsvc-2"},
        {7070, "realserver"},
        {7100, "font-service"},
        {7103, "unknown"},
        {7106, "unknown"},
        {7200, "fodms"},
        {7201, "dlip"},
        {7402, "rtps-dd-mt"},
        {7435, "unknown"},
        {7443, "oracleas-https"},
        {7496, "unknown"},
        {7512, "unknown"},
        {7625, "unknown"},
        {7627, "soap-http"},
        {7676, "imqbrokerd"},
        {7741, "scriptview"},
        {7777, "cbt"},
        {7778, "interwise"},
        {7800, "asr"},
        {7911, "unknown"},
        {7920, "unknown"},
        {7921, "unknown"},
        {7937, "nsrexecd"},
        {7938, "lgtomapper"},
        {7999, "irdmi2"},
        {8000, "http-alt"},
        {8001, "vcom-tunnel"},
        {8002, "teradataordbms"},
        {8007, "ajp12"},
        {8008, "http"},
        {8009, "ajp13"},
        {8010, "xmpp"},
        {8011, "unknown"},
        {8021, "ftp-proxy"},
        {8022, "oa-system"},
        {8031, "unknown"},
        {8042, "fs-agent"},
        {8045, "unknown"},
        {8080, "http-proxy"},
        {8081, "blackice-icecap"},
        {8082, "blackice-alerts"},
        {8083, "us-srv"},
        {8084, "websnp"},
        {8085, "unknown"},
        {8086, "d-s-n"},
        {8087, "simplifymedia"},
        {8088, "radan-http"},
        {8089, "unknown"},
        {8090, "opsmessaging"},
        {8093, "unknown"},
        {8099, "unknown"},
        {8100, "xprint-server"},
        {8180, "unknown"},
        {8181, "intermapper"},
        {8192, "sophos"},
        {8193, "sophos"},
        {8194, "sophos"},
        {8200, "trivnet1"},
        {8222, "unknown"},
        {8254, "unknown"},
        {8290, "unknown"},
        {8291, "unknown"},
        {8292, "blp3"},
        {8300, "tmi"},
        {8333, "bitcoin"},
        {8383, "m2mservices"},
        {8400, "cvd"},
        {8402, "abarsd"},
        {8443, "https-alt"},
        {8500, "fmtp"},
        {8600, "asterix"},
        {8649, "unknown"},
        {8651, "unknown"},
        {8652, "unknown"},
        {8654, "unknown"},
        {8701, "unknown"},
        {8800, "sunwebadmin"},
        {8873, "dxspider"},
        {8888, "sun-answerbook"},
        {8899, "ospf-lite"},
        {8994, "unknown"},
        {9000, "cslistener"},
        {9001, "tor-orport"},
        {9002, "dynamid"},
        {9003, "unknown"},
        {9009, "pichat"},
        {9010, "sdr"},
        {9011, "d-star"},
        {9040, "tor-trans"},
        {9050, "tor-socks"},
        {9071, "unknown"},
        {9080, "glrpc"},
        {9081, "cisco-aqos"},
        {9090, "zeus-admin"},
        {9091, "xmltec-xmlmail"},
        {9099, "unknown"},
        {9100, "jetdirect"},
        {9101, "jetdirect"},
        {9102, "jetdirect"},
        {9103, "jetdirect"},
        {9110, "unknown"},
        {9111, "DragonIDSConsole"},
        {9200, "wap-wsp"},
        {9207, "wap-vcal-s"},
        {9220, "unknown"},
        {9290, "unknown"},
        {9415, "unknown"},
        {9418, "git"},
        {9485, "unknown"},
        {9500, "ismserver"},
        {9502, "unknown"},
        {9503, "unknown"},
        {9535, "man"},
        {9575, "unknown"},
        {9593, "cba8"},
        {9594, "msgsys"},
        {9595, "pds"},
        {9618, "condor"},
        {9666, "zoomcp"},
        {9876, "sd"},
        {9877, "x510"},
        {9878, "kca-service"},
        {9898, "monkeycom"},
        {9900, "iua"},
        {9917, "unknown"},
        {9929, "nping-echo"},
        {9943, "unknown"},
        {9944, "unknown"},
        {9968, "unknown"},
        {9998, "distinct32"},
        {9999, "abyss"},
        {10000, "snet-sensor-mgmt"},
        {10001, "scp-config"},
        {10002, "documentum"},
        {10003, "documentum_s"},
        {10004, "emcrmirccd"},
        {10009, "swdtp-sv"},
        {10010, "rxapi"},
        {10012, "unknown"},
        {10024, "unknown"},
        {10025, "unknown"},
        {10082, "amandaidx"},
        {10180, "unknown"},
        {10215, "unknown"},
        {10243, "unknown"},
        {10566, "unknown"},
        {10616, "unknown"},
        {10617, "unknown"},
        {10621, "unknown"},
        {10626, "unknown"},
        {10628, "unknown"},
        {10629, "unknown"},
        {10778, "unknown"},
        {11110, "sgi-soap"},
        {11111, "vce"},
        {11967, "sysinfo-sp"},
        {12000, "cce4x"},
        {12174, "unknown"},
        {12265, "unknown"},
        {12345, "netbus"},
        {13456, "unknown"},
        {13722, "netbackup"},
        {13782, "netbackup"},
        {13783, "netbackup"},
        {14000, "scotty-ft"},
        {14238, "unknown"},
        {14441, "unknown"},
        {14442, "unknown"},
        {15000, "hydap"},
        {15002, "onep-tls"},
        {15003, "unknown"},
        {15004, "unknown"},
        {15660, "bex-xr"},
        {15742, "unknown"},
        {16000, "fmsas"},
        {16001, "fmsascon"},
        {16012, "unknown"},
        {16016, "unknown"},
        {16018, "unknown"},
        {16080, "osxwebadmin"},
        {16113, "unknown"},
        {16992, "amt-soap-http"},
        {16993, "amt-soap-https"},
        {17877, "unknown"},
        {17988, "unknown"},
        {18040, "unknown"},
        {18101, "unknown"},
        {18988, "unknown"},
        {19101, "unknown"},
        {19283, "keysrvr"},
        {19315, "keyshadow"},
        {19350, "unknown"},
        {19780, "unknown"},
        {19801, "unknown"},
        {19842, "unknown"},
        {20000, "dnp"},
        {20005, "btx"},
        {20031, "unknown"},
        {20221, "unknown"},
        {20222, "ipulse-ics"},
        {20828, "unknown"},
        {21571, "unknown"},
        {22939, "unknown"},
        {23502, "unknown"},
        {24444, "unknown"},
        {24800, "unknown"},
        {25734, "unknown"},
        {25735, "unknown"},
        {26214, "unknown"},
        {27000, "flexlm0"},
        {27352, "unknown"},
        {27353, "unknown"},
        {27355, "unknown"},
        {27356, "unknown"},
        {27715, "unknown"},
        {28201, "unknown"},
        {30000, "ndmps"},
        {30718, "unknown"},
        {30951, "unknown"},
        {31038, "unknown"},
        {31337, "Elite"},
        {32768, "filenet-tms"},
        {32769, "filenet-rpc"},
        {32770, "sometimes-rpc3"},
        {32771, "sometimes-rpc5"},
        {32772, "sometimes-rpc7"},
        {32773, "sometimes-rpc9"},
        {32774, "sometimes-rpc11"},
        {32775, "sometimes-rpc13"},
        {32776, "sometimes-rpc15"},
        {32777, "sometimes-rpc17"},
        {32778, "sometimes-rpc19"},
        {32779, "sometimes-rpc21"},
        { 32780, "sometimes-rpc23"},
        { 32781, "unknown"},
        { 32782, "unknown"},
        { 32783, "unknown"},
        { 32784, "unknown"},
        { 32785, "unknown"},
        { 33354, "unknown"},
        { 33899, "unknown"},
        { 34571, "unknown"},
        { 34572, "unknown"},
        { 34573, "unknown"},
        { 35500, "unknown"},
        { 38292, "landesk-cba"},
        { 40193, "unknown"},
        { 40911, "unknown"},
        { 41511, "unknown"},
        { 42510, "caerpc"},
        { 44176, "unknown"},
        { 44442, "coldfusion-auth"},
        { 44443, "coldfusion-auth"},
        { 44501, "unknown"},
        { 45100, "unknown"},
        { 48080, "unknown"},
        { 49152, "unknown"},
        { 49153, "unknown"},
        { 49154, "unknown"},
        { 49155, "unknown"},
        { 49156, "unknown"},
        { 49157, "unknown"},
        { 49158, "unknown"},
        { 49159, "unknown"},
        { 49160, "unknown"},
        { 49161, "unknown"},
        { 49163, "unknown"},
        { 49165, "unknown"},
        { 49167, "unknown"},
        { 49175, "unknown"},
        { 49176, "unknown"},
        { 49400, "compaqdiag"},
        { 49999, "unknown"},
        { 50000, "ibm-db2"},
        { 50001, "unknown"},
        { 50002, "iiimsf"},
        { 50003, "unknown"},
        { 50006, "unknown"},
        { 50300, "unknown"},
        { 50389, "unknown"},
        { 50500, "unknown"},
        { 50636, "unknown"},
        { 50800, "unknown"},
        { 51103, "unknown"},
        { 51493, "unknown"},
        { 52673, "unknown"},
        { 52822, "unknown"},
        { 52848, "unknown"},
        { 52869, "unknown"},
        { 54045, "unknown"},
        { 54328, "unknown"},
        { 55055, "unknown"},
        { 55056, "unknown"},
        { 55555, "unknown"},
        { 55600, "unknown"},
        { 56737, "unknown"},
        { 56738, "unknown"},
        { 57294, "unknown"},
        { 57797, "unknown"},
        { 58080, "unknown"},
        { 60020, "unknown"},
        { 60443, "unknown"},
        { 61532, "unknown"},
        { 61900, "unknown"},
        { 62078, "iphone-sync"},
        { 63331, "unknown"},
        { 64623, "unknown"},
        { 64680, "unknown"},
        { 65000, "unknown"},
        { 65129, "unknown"},
        { 65389, "unknown"}
    };
}
void commandp::scanPorts(const QString &ip, const QList<int> &ports) {
    QMap<int, QString> portServices = getServiceNames();

    qDebug() << "Starting..............................";
    qDebug() << "Timap scan report for" << ip;

    QElapsedTimer totalTimer;
    totalTimer.start();
    qDebug() << "Host is up.\n";

    qDebug() << "PORT      STATE SERVICE     LATENCY";

    for (int port : ports) {
        QString service = portServices.value(port, "unknown");

        QTcpSocket socket;
        QElapsedTimer timer;
        timer.start();
        socket.connectToHost(ip, port);

        if (socket.waitForConnected(100)) {
            qint64 latency = timer.nsecsElapsed();
            qDebug().nospace() << QString("%1/tcp   open  %2   %3 ms")
                                      .arg(port, -8)
                                      .arg(service, -12)
                                      .arg(latency / 1000000.0, 0, 'f', 2);

            socket.disconnectFromHost();


            if (socket.state() == QAbstractSocket::ConnectedState) {
                socket.waitForDisconnected(100);
            }
        } else {
            qDebug().nospace() << QString("%1/tcp   closed %2")
            .arg(port, -8)
                .arg(service, -12);
        }

        QThread::msleep(10);
    }

    qint64 totalTime = totalTimer.elapsed();
    qDebug() << "\nScan completed in" << totalTime / 1000.0 << "seconds.";
}
